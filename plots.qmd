---
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r}
library(tidyverse)
library(stringr)
library(dplyr)
library(rvest)
library(httr)
library(spotifyr)
library(ggplot2)
```


```{r}
songs = read_rds("songs.csv")
genres = read_rds("genres.csv")
artists = read_rds("artists.csv")
```

```{r}
genres |>
  ggplot(aes(x = genre, y = followers.total)) +
  geom_boxplot()

genres |>
  ggplot(aes(x = genre, y = popularity)) +
  geom_boxplot()
```

```{r}
songs |>
  ggplot(aes(x = album_release_year, y = tempo, color = genre)) +
  geom_point() + 
  facet_wrap(~genre)

songs |>
  filter(genre == "indie") |>
  ggplot(aes(x = album_release_year, y = tempo, color = genre)) +
  geom_point() + 
  geom_smooth(method = "lm", se = F)

songs |>
  ggplot(aes(x = popularity, y = energy, color = genre)) +
  geom_point()

songs |>
  ggplot(aes(x = duration_ms, y = popularity, color = genre)) +
  geom_point()

songs |>
  group_by(album_name) |>
  mutate(num_songsalbum = n()) |>
  ggplot(aes(x = popularity, y = num_songsalbum, color = genre)) +
  geom_violin()

songs |>
  ggplot(aes(x = danceability, color = genre)) +
  geom_density()

songs |>
  group_by(album_name) |>
  mutate(num_songsalbum = n()) |>
  ggplot(aes(x = album_release_year, y = num_songsalbum, color = genre)) +
  geom_point()

songs |>
  filter(genre == "country") |>
  group_by(album_name) |>
  mutate(num_songsalbum = n()) |>
  ggplot(aes(x = album_release_year, y = num_songsalbum, color = name)) +
  geom_point() +
  geom_smooth(se = F)

songs |>
  filter(genre == "hip-hop") |>
  ggplot(aes(x = album_release_year, y = duration_ms)) +
  geom_point() + 
  geom_smooth(se = F)

songs |>
  ggplot(aes(x = tempo, y = danceability, color = genre)) +
  geom_point()
```

