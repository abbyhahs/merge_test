---
title: "Final_Belle"
output: flexdashboard::flex_dashboard
runtime: shiny
---

```{r global, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(viridis)
library(ggmosaic)
library(shiny)
library(ggiraph)
```

```{r, echo = FALSE}
songs = read_rds("songs.csv")
genres = read_rds("genres.csv")
artists = read_rds("artists.csv")

songs2 <- 
  songs |>
  mutate(duration_m = duration_ms/60000)

```


1
==========================


Column {data-width = 200}
-------------------------
```{r, echo = FALSE}
ggplot(data = songs) + 
  geom_mosaic(aes(x = product(genre), fill = mode_name))+
  labs(x = "Genre",
       title = "Mode For Each Genre",
       fill = "Mode") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  geom_mosaic_text(aes(x = product(mode_name, genre),
label = after_stat(.wt))) 

ggplot(data = songs) + 
  geom_mosaic(aes(x = product(genre), fill = key_name))+
  labs(x = "Genre",
       title = "Key For Each Genre",
       fill = "Key") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  geom_mosaic_text(aes(x = product(key_name, genre),
label = after_stat(.wt)))


```


Column {data-width = 200}
-------------------------
```{r, echo = FALSE}
ggplot(data = songs) + 
  geom_mosaic(aes(x = product(mode_name), fill = key_name))+
  labs(x = "Mode",
       title = "Key For Each Mode",
       fill = "Key",
       x = "Mode") +
  geom_mosaic_text(aes(x = product(key_name, mode_name),
label = after_stat(.wt)))

```




2
==========================

```{r, echo = FALSE}
inputPanel(
 selectInput("genre4", label = "Genre:", 
             choices = c("R&B" = "R&B",
                         "Christian" = "christian",
                         "Country" = "country",
                         "EDM" = "edm",
                         "Hip-Hop" = "hip-hop",
                         "Indie" = "indie",
                         "Latin" = "latin",
                         "Pop" = "pop",
                         "Rap" = "rap",
                         "Rock" = "rock"))
)
```

Column {data-width = 200}
-------------------------

```{r, echo = FALSE}
renderPlot({
  songs2 %>%
    filter(genre == input$genre4)|>
    
  ggplot() +
    geom_mosaic(aes(x = product(name), fill = key_name)) +
    labs(x = "Singer Name", y = "Key of Songs", color = "Artist Name") + 
    theme_classic() + 
    scale_color_calc()
})
```


Column {data-width = 200}
-------------------------------------
```{r, echo = FALSE}
renderPlot({
  songs2 %>%
    filter(genre == input$genre4)|>
    
  ggplot() +
    geom_bar(aes(x = name, fill = mode_name)) +
    labs(x = "Singer Name", y = "Mode of Song", color = "Artist Name") + 
    theme_classic() + 
    scale_color_calc()
})
```
